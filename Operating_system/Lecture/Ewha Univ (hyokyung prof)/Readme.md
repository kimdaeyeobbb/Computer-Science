
# System Structure & Program Execution 



# Process





# Process Management 1

## 프로세스 생성 (Process Creation)

- 프로세스 생성 원리: 복제 생성 (부모가 자식을 복제해서 만듦. 자식은 여러명 낳을 수 있음)

- 이로 인해 프로세스의 트리(계층 구조) 형성 (부모가 자식을 여러명 만드는 경우를 떠올릴 것)

- 프로세스가 생성되기 위해서는 자원이 필요하다 (자원은 OS로 부터 받는다)

- 자원의 공유
  - 자원은 부모와 자식이 공유한다 (경우에 따라 자원을 공유하지 않을 수도 있다)
  - 자원을 일부를 공유할 수도, 전혀 공유하지 않을 수도 있다
  
- 수행 (Execution) => 프로세스가 실행이 되는 경우
  - 부모와 자식은 공존하면서 수행되는 모델이다
  - 자식이 종료(terminate)될 때까지 부모가 기다리는(wait) 모델이다 <b>(blocked 상태)</b>
  

- 프로세스 생성 단계 (2단계를 거침. 각 단계는 독립적)
  1) 부모 프로세스를 복제
  2) 복제된 것에 새로운 프로그램을 덮어 씌우는 단계 
  
- 주소 공간 (Address space)
  - 자식은 부모의 주소 공간을 복사함 (binary, OS data, PCB나 자원들도 복사)
  - 자식은 복제된 공간에 새로운 프로그램을 올림 => 이로인해 서로 다른 프로그램이 컴퓨터 내에 존재할 수 있음
  
 - 유닉스 예시
    1. fork() system call
        - fork() 시스템 콜이 복제를 통해 부모를 그대로 복사하여 새로운 프로세스를 생성
        - 그 과정에서 주소 공간을 할당하게 된다

    2. exec() system call
        - (복제 생성 후) 다른 프로그램으로 덮어 씌우는 역할을 한다
        - fork 다음에 이어지는 exec() 시스템 콜을 통해 새로운 프로그램을 메모리에 올린다
        - 이를 통해 새로운 인생을 살 수 있다 (이때까지의 삶이 맘에 들지 않을 경우 모조리 덮어씌울 수 있다)
         
<br>

## 프로세스 종료 (Process Termination)

- 프로세스 세계의 원칙
  - 부모 프로세스가 자식 프로세스를 낳으면 자식이 먼저 종료되어야 함 (이후의 일을 부모가 처리)

1. exit() system call
    - exit 시스템 콜을 하면 자발적으로 프로세스가 종료됨
    - 프로세스가 마지막 명령을 수행한 후 OS에게 이를 알려줌
    - 프로세스의 각종 자원들이 OS에게 반납됨

      - wait() system call
          - 프로세스 종료 시 자식이 부모에게 output data를 보냄 (wait 시스템 콜을 통해 이루어짐)

2. abort() system call
    - 부모 프로세스가 자식의 수행을 종료시킴
    - 비자발적 프로세스 종료
    - abort() system call을 사용하는 경우
        
        1. 자식의 할당 자원이 한계치를 넘어섬
        2. 자식에게 할당된 task가 더 이상 필요하지 않음 (더 이상 자식에게 시킬 일이 없는 경우)
        3. 부모가 종료하는 경우 (프로세스 세계에서는 자식 프로세스가 먼저 종료된 후 부모 프로세스가 종료 되어야 함)
            - 자식부터 죽이면서 위로 올라가면서 종료가 이루어져야 함 
